/* Disable results caching */
set enable_result_cache_for_session to off;

/* TPC_H  Query 18 - Large Volume Customer */
set query_group='RSPERF TPC-H 1.18';
SELECT	/* sql-18 */ TOP 100000
	C_NAME,
	C_CUSTKEY,
	O_ORDERKEY,
	O_ORDERDATE,
	O_TOTALPRICE,
	SUM(L_QUANTITY)
FROM	CUSTOMER,
	ORDERS,
	LINEITEM
WHERE	O_ORDERKEY	IN	(	SELECT	L_ORDERKEY
					FROM	LINEITEM
					GROUP	BY	L_ORDERKEY HAVING SUM(L_QUANTITY) > 313
				)	AND
	C_CUSTKEY	= O_CUSTKEY	AND
	O_ORDERKEY	= L_ORDERKEY
GROUP	BY	C_NAME,
		C_CUSTKEY,
		O_ORDERKEY,
		O_ORDERDATE,
		O_TOTALPRICE
ORDER	BY	O_TOTALPRICE	DESC,
		O_ORDERDATE
;